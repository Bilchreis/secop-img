\documentclass[margin=10pt]{standalone}
\usepackage{color,xcolor}

\usepackage[utf8]{inputenc} 

\input{../praeambel}

\newcommand{\propsize}{\footnotesize}
\newcommand{\proptextw}{2.2cm}
\newcommand{\propcol}{blue!15}


\tikzset{% NodeInstance
	base/.style    = {draw, thick, rectangle, minimum height = 3em,
		minimum width = 5em, inner sep=1em,node distance=3em,rounded corners=0.8em},
	ecs/.style = {object,fill=orange!30,font = \Large\ttfamily},
	node/.style = {
		base,
		font=\large,
		rectangle split,
		rectangle split horizontal,
		rectangle split part fill={green!30,\propcol},
		rectangle split parts=2
		%text width =2cm
	},
	property/.style = {base,fill=blue!5,font=\scriptsize, minimum height = 2em,
		minimum width = 2em, align=center,node distance=0.2em,inner sep=0.5em,rounded corners=0.5em},
	module/.style = {
		base,
		font=\large,
		rectangle split,
		rectangle split horizontal,
		rectangle split part fill={red!20,\propcol},
		rectangle split parts=2
		%text width =2cm
	},
	parameter/.style = {
		base,
		font=\large,
		rectangle split,
		rectangle split horizontal,
		rectangle split part fill={yellow!20,\propcol},
		rectangle split parts=2,
		node distance = 1mm
		%text width =2cm
	},
	command/.style = {
		base,
		font=\large,
		rectangle split,
		rectangle split horizontal,
		rectangle split part fill={yellow!20,\propcol},
		rectangle split parts=2,
		node distance = 1mm
		%text width =2cm
	},
	block/.style = {
		rounded corners=0.8em,
		inner sep = 0.2cm,
		draw=black
	},
	module_no_split/.style = {
		base,
		font=\large,
		fill=red!20,
	},
	acessibles/.style ={font= \ttfamily\large,node distance = 1mm},
	consists/.style ={
	line width=0.5mm
	},
	secop/.style ={
		line width=0.5mm,
		color = purple
	},
	every text node part/.style={align=center}
		
}

\begin{document}
	
	
	
\footnotesize

\pgfdeclarelayer{background layer}
\pgfdeclarelayer{foreground layer}
\pgfsetlayers{background layer,main,foreground layer}

	\begin{tikzpicture}[auto, thick, node distance=2cm, >=triangle 45,every text node part/.style={align=center}]
	
	\draw
	node at (0,0) [ecs] (ecs) {Experimental Control System}
	
	node [node,below = of ecs,xshift = -4cm,yshift = -1cm] (NodeA) {\texttt{Node A} \nodepart[text width=\proptextw]{two}  
		\footnotesize \texttt{Properties:}\\		
		\propsize\texttt{%
		$\bullet$ description\\%
		$\bullet$ equipment\_id\\%
		$\bullet$ ...\\}
	} 

	node [node,below = of ecs,xshift = 4cm,yshift = -1cm] (NodeB) {\texttt{Node B} \nodepart[text width=\proptextw]{two}  
	\footnotesize \texttt{Properties:}\\		
	\propsize\texttt{%
		$\bullet$ description\\%
		$\bullet$ equipment\_id\\%
		$\bullet$ ...\\}
	} 
	

	node [module,below= of NodeA] (mod1){\texttt{Module A.1} \nodepart[text width=3cm]{two}  
		\footnotesize \texttt{Properties:}\\		
		\propsize\texttt{%
			$\bullet$ description\\%
			$\bullet$ interface\_classes\\%
			$\bullet$ ...\\}
	} 


	node [module_no_split,below = of NodeB,xshift = -1.7cm] (modB1) {\texttt{Module B.1}}
	node [module_no_split,below = of NodeB,xshift = 1.7cm] (modB2) {\texttt{Module B.2}}

	;
	\begin{pgfonlayer}{foreground layer}
	\draw
	node [acessibles,below= of mod1,yshift = -1cm,font = \Large\ttfamily] (accs){Accessibles} 
	node [acessibles,below= of accs,yshift = -0.3cm] (params){Parameters} 
	
	
	node [parameter,below = of params] (para1){
		\nodepart[text width=1.3cm]{one} 
		\texttt{value} \nodepart[text width=2.3cm]{two}  
		\footnotesize \texttt{Properties:}\\		
		\propsize\texttt{%
			$\bullet$ description\\%
			$\bullet$ data\_info\\%
			$\bullet$ ...\\}
	
	}
	node [parameter,below = of para1] (para2){
	\nodepart[text width=1.3cm]{one}
	\texttt{status} \nodepart[text width=2.3cm]{two}  
	\footnotesize \texttt{Properties:}\\		
	\propsize\texttt{%
		$\bullet$ description\\%
		$\bullet$ data\_info\\%
		$\bullet$ ...\\}
	}
	node [parameter,below = of para2] (para3){
	\nodepart[text width=1.3cm]{one}
	\texttt{...} \nodepart[text width=2.3cm]{two}  
	\footnotesize \texttt{Properties:}\\		
	\propsize\texttt{%
		$\bullet$ ...\\}
	}


	node [command,right= of para1,node distance = 1mm,xshift = 0.5cm] (cmd1){
	\nodepart[text width=1.3cm]{one}
	\texttt{stop} \nodepart[text width=2.3cm]{two}  
	\footnotesize \texttt{Properties:}\\		
	\propsize\texttt{%
	$\bullet$ description\\%
	$\bullet$ data\_info\\%
	$\bullet$ ...\\}
	}

	node [acessibles,above= of cmd1] (commands){Commands} 
	
	node [parameter,below = of cmd1] (cmd2){
	\nodepart[text width=1.3cm]{one}
	\texttt{...} \nodepart[text width=2.3cm]{two}  
	\footnotesize \texttt{Properties:}\\		
	\propsize\texttt{%
		$\bullet$ ...\\}
	}
	;
	 \end{pgfonlayer}
	\node [block,thick, fill= yellow!15 ,fit={(commands) (cmd1) (cmd2) }] (cmd_block){};
	\node [block,thick, fill= yellow!15, fit={(params) (para1) (para2) (para3) }] (param_block){};
	
	\begin{pgfonlayer}{background layer}

	\node [block, fill= yellow!15,thick,fit= {(cmd_block)(param_block)(accs)}] (accessibles) {-};
	\end{pgfonlayer}

	

	
	
	
	
	
	
	\draw[<->,secop] (ecs) -- (NodeA)  node[midway,above,xshift =0.1cm,sloped] {\textbf{SECoP}} ;
	\draw[<->,secop] (ecs) -- (NodeA)  node[midway,below,xshift =0.1cm,sloped] {\textit{TCP}} ;
	
	\draw[<->,secop] (ecs) -- (NodeB)  node[midway,above,xshift =0.1cm,sloped] {\textbf{SECoP}} ;
	\draw[<->,secop] (ecs) -- (NodeB)  node[midway,below,xshift =0.1cm,sloped] {\textit{TCP}} ;
	
	\draw[-,consists] (NodeA) --(mod1);
	%\draw[-,consists] (mod1) --(acc1);

	\draw[-,consists] (NodeB) --(modB1);
	\draw[-,consists] (NodeB) --(modB2);
	
	\draw[-,consists] (accessibles) -- (mod1);
	

	
\end{tikzpicture}


	
	
	
\end{document}